import{r,i as z,j as C,s as m,u as P,c as u,a as e,b as g,t as x,w as M,d as y,v as b,n as S,e as k,f as V,g as A,h as T,o as c}from"./main-CXxHQZ5I.js";const U={class:"min-h-screen bg-gradient-to-br from-primary-600 via-primary-700 to-secondary-600 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8"},N={class:"max-w-md w-full space-y-8"},j={key:0,class:"p-4 mb-4 text-sm text-green-700 bg-green-100 rounded-lg"},B={key:1,class:"p-4 mb-4 text-sm text-red-700 bg-red-100 rounded-lg"},D={class:"rounded-md shadow-sm space-y-4"},E=["disabled"],R={key:0},q={key:1,class:"flex items-center"},L={class:"text-center text-sm mt-4"},G={__name:"UpdatePassword",setup(O){const p=P(),n=r(""),f=r(""),l=r(!1),o=r(""),d=r("");r("");const w=z(()=>n.value===f.value&&n.value.length>=6);C(async()=>{try{const t=window.location.hash;if(t){const i=new URLSearchParams(t.substring(1)),a=i.get("access_token"),v=i.get("refresh_token");if(i.get("type")==="recovery"&&a&&v){const{error:h}=await m.auth.setSession({access_token:a,refresh_token:v});if(h)throw h;window.history.replaceState({},document.title,"/update-password");return}}const{data:{session:s}}=await m.auth.getSession();s||p.push("/login")}catch(t){console.error("Erro ao verificar autenticaÃ§Ã£o:",t),p.push("/login")}});const _=async()=>{if(!w.value){o.value="As senhas nÃ£o coincidem ou sÃ£o muito curtas.";return}l.value=!0,o.value="",d.value="";try{const{error:t}=await m.auth.updateUser({password:n.value});if(t)throw t;await m.auth.signOut(),d.value="Senha atualizada com sucesso! Redirecionando para o login...",setTimeout(()=>{p.push("/login")},2e3)}catch(t){console.error("Erro ao atualizar a senha:",t),t.message.includes("Auth session missing")?o.value="SessÃ£o expirada. Por favor, solicite um novo link de redefiniÃ§Ã£o.":t.message.includes("Password should be at least 6 characters")?o.value="A senha deve ter pelo menos 6 caracteres.":o.value="Ocorreu um erro ao atualizar a senha. Tente novamente."}finally{l.value=!1}};return(t,s)=>{const i=T("router-link");return c(),u("div",U,[e("div",N,[s[7]||(s[7]=e("div",null,[e("div",{class:"mx-auto h-16 w-16 bg-white/10 backdrop-blur-sm rounded-2xl flex items-center justify-center"},[e("span",{class:"text-3xl"},"ðŸ”’")]),e("h2",{class:"mt-6 text-center text-3xl font-extrabold text-white"}," Criar nova senha "),e("p",{class:"mt-2 text-center text-sm text-blue-100"}," Digite e confirme sua nova senha ")],-1)),d.value?(c(),u("div",j,x(d.value),1)):g("",!0),o.value?(c(),u("div",B,x(o.value),1)):g("",!0),e("form",{class:"mt-8 space-y-6",onSubmit:M(_,["prevent"])},[e("div",D,[e("div",null,[s[2]||(s[2]=e("label",{for:"password",class:"block text-sm font-medium text-white mb-1"}," Nova senha ",-1)),y(e("input",{id:"password","onUpdate:modelValue":s[0]||(s[0]=a=>n.value=a),name:"password",type:"password",autocomplete:"new-password",required:"",minlength:"6",class:"appearance-none rounded-lg relative block w-full px-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-2 focus:ring-yellow-400 focus:border-yellow-400 focus:z-10 sm:text-sm",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"},null,512),[[b,n.value]]),s[3]||(s[3]=e("p",{class:"mt-1 text-xs text-gray-300"},"MÃ­nimo de 6 caracteres",-1))]),e("div",null,[s[4]||(s[4]=e("label",{for:"confirmPassword",class:"block text-sm font-medium text-white mb-1"}," Confirme a nova senha ",-1)),y(e("input",{id:"confirmPassword","onUpdate:modelValue":s[1]||(s[1]=a=>f.value=a),name:"confirmPassword",type:"password",autocomplete:"new-password",required:"",minlength:"6",class:"appearance-none rounded-lg relative block w-full px-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-2 focus:ring-yellow-400 focus:border-yellow-400 focus:z-10 sm:text-sm",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"},null,512),[[b,f.value]])])]),e("div",null,[e("button",{type:"submit",disabled:l.value||!w.value,class:S(["group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-yellow-500 hover:bg-yellow-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-400 transition-colors duration-200",{"opacity-50 cursor-not-allowed":l.value||!w.value}])},[l.value?(c(),u("span",q,s[5]||(s[5]=[e("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),k(" Atualizando... ")]))):(c(),u("span",R,"Atualizar senha"))],10,E)])],32),e("div",L,[V(i,{to:"/login",class:"text-yellow-300 hover:text-yellow-200 underline"},{default:A(()=>s[6]||(s[6]=[k(" Voltar para o login ")])),_:1,__:[6]})])])])}}};export{G as default};
